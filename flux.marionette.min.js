/**
 * almond 0.1.2 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

(function(e,t){if(typeof define=="function"&&define.amd)define(["backbone.marionette","backbone.radio"],function(n,r){return e.FluxMarionette=t(e,n,r)});else if(typeof exports!="undefined"){var n=require("backbone.marionette"),r=require("backbone.radio");module.exports=t(e,n,r)}else e.FluxMarionette=t(e,e.Marionette,e.Backbone.Radio)})(this,function(e,t,n){var r,i,s;(function(e){function c(e,t){var n=t&&t.split("/"),r=o.map,i=r&&r["*"]||{},s,u,a,f,l,c,h,p,d,v;if(e&&e.charAt(0)==="."&&t){n=n.slice(0,n.length-1),e=n.concat(e.split("/"));for(p=0;v=e[p];p++)if(v===".")e.splice(p,1),p-=1;else if(v===".."){if(p===1&&(e[2]===".."||e[0]===".."))return!0;p>0&&(e.splice(p-1,2),p-=2)}e=e.join("/")}if((n||i)&&r){s=e.split("/");for(p=s.length;p>0;p-=1){u=s.slice(0,p).join("/");if(n)for(d=n.length;d>0;d-=1){a=r[n.slice(0,d).join("/")];if(a){a=a[u];if(a){f=a,l=p;break}}}if(f)break;!c&&i&&i[u]&&(c=i[u],h=p)}!f&&c&&(f=c,l=h),f&&(s.splice(0,l,f),e=s.join("/"))}return e}function h(t,n){return function(){return l.apply(e,a.call(arguments,0).concat([t,n]))}}function p(e){return function(t){return c(t,e)}}function d(e){return function(n){t[e]=n}}function v(r){if(n.hasOwnProperty(r)){var i=n[r];delete n[r],u[r]=!0,f.apply(e,i)}if(!t.hasOwnProperty(r))throw new Error("No "+r);return t[r]}function m(e,t){var n,r,i=e.indexOf("!");return i!==-1?(n=c(e.slice(0,i),t),e=e.slice(i+1),r=v(n),r&&r.normalize?e=r.normalize(e,p(t)):e=c(e,t)):e=c(e,t),{f:n?n+"!"+e:e,n:e,p:r}}function g(e){return function(){return o&&o.config&&o.config[e]||{}}}var t={},n={},o={},u={},a=[].slice,f,l;f=function(r,i,s,o){var a=[],f,l,c,p,y,b;o=o||r;if(typeof s=="function"){i=!i.length&&s.length?["require","exports","module"]:i;for(b=0;b<i.length;b++){y=m(i[b],o),c=y.f;if(c==="require")a[b]=h(r);else if(c==="exports")a[b]=t[r]={},f=!0;else if(c==="module")l=a[b]={id:r,uri:"",exports:t[r],config:g(r)};else if(t.hasOwnProperty(c)||n.hasOwnProperty(c))a[b]=v(c);else if(y.p)y.p.load(y.n,h(o,!0),d(c),{}),a[b]=t[c];else if(!u[c])throw new Error(r+" missing "+c)}p=s.apply(t[r],a);if(r)if(l&&l.exports!==e&&l.exports!==t[r])t[r]=l.exports;else if(p!==e||!f)t[r]=p}else r&&(t[r]=s)},r=i=l=function(t,n,r,i){return typeof t=="string"?v(m(t,n).f):(t.splice||(o=t,n.splice?(t=n,n=r,r=null):t=e),n=n||function(){},i?f(e,t,n,r):setTimeout(function(){f(e,t,n,r)},15),l)},l.config=function(e){return o=e,l},s=function(e,t,r){t.splice||(r=t,t=[]),n[e]=[e,t,r]},s.amd={jQuery:!0}})(),s("../tools/almond",function(){}),s("mixins/dispatcher",["require","backbone.radio"],function(e){function n(e,t,n,r){if(!this.debug)return;var i="color:black; font-weight: bold;",s="color:black;",o="color:black;";this.type()==="store"&&(o="color: #0066FF; font-style: italic;"),this.type()==="view"&&(o="color: #006600; font-style: italic;"),this.type()==="router"&&(o="color: #CC3300; font-style: italic;");var u=this.name||"a",a=this.type();n&&(u="Dispatcher",a=n,o="color: #CC00CC; font-style: italic;");var f=n?" data request in the ":r?" handled by ":" sent from ";console.debug((r?" â†ª ":"")+" %c"+e+"%c"+f+u+"%c "+a,i,s,o,t)}var t=e("backbone.radio");return{dispatcher:t.channel("dispatcher"),type:function(){if(typeof this.attributes!="undefined")return"store";if(typeof this.routes!="undefined")return"router";if(typeof this.render!="undefined")return"view"},dispatch:function(e,t){n.call(this,e,t),this.dispatcher.trigger(e,t)}}}),s("lib/md5",["require"],function(e){!function(e){function p(e){var t="",n="",r=0,i=0;for(var s=0,o=e.length;s<o;s++){var u=e.charCodeAt(s);if(u<128){i++;continue}u<2048?n=String.fromCharCode(u>>6|192,u&63|128):n=String.fromCharCode(u>>12|224,u>>6&63|128,u&63|128),i>r&&(t+=e.slice(r,i)),t+=n,r=i=s+1}return i>r&&(t+=e.slice(r,o)),t}function d(e){var t,s;e+="",a=!1,f=l=e.length;if(l>63){v(e.substring(0,64)),y(r),a=!0;for(t=128;t<=l;t+=64)v(e.substring(t-64,t)),b(r);e=e.substring(t-64),l=e.length}n[0]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=n[13]=n[14]=n[15]=0;for(t=0;t<l;t++)s=t&3,s===0?n[t>>2]=e.charCodeAt(t):n[t>>2]|=e.charCodeAt(t)<<o[s];n[t>>2]|=i[t&3];if(t>55)return a?b(n):(y(n),a=!0),b([0,0,0,0,0,0,0,0,0,0,0,0,0,0,f<<3,0]);n[14]=f<<3,a?b(n):y(n)}function v(e){for(var t=16;t--;){var n=t<<2;r[t]=e.charCodeAt(n)+(e.charCodeAt(n+1)<<8)+(e.charCodeAt(n+2)<<16)+(e.charCodeAt(n+3)<<24)}}function m(e,n,r){d(n?e:p(e));var i=u[0];return t[1]=s[i&15],t[0]=s[(i>>=4)&15],t[3]=s[(i>>=4)&15],t[2]=s[(i>>=4)&15],t[5]=s[(i>>=4)&15],t[4]=s[(i>>=4)&15],t[7]=s[(i>>=4)&15],t[6]=s[(i>>=4)&15],i=u[1],t[9]=s[i&15],t[8]=s[(i>>=4)&15],t[11]=s[(i>>=4)&15],t[10]=s[(i>>=4)&15],t[13]=s[(i>>=4)&15],t[12]=s[(i>>=4)&15],t[15]=s[(i>>=4)&15],t[14]=s[(i>>=4)&15],i=u[2],t[17]=s[i&15],t[16]=s[(i>>=4)&15],t[19]=s[(i>>=4)&15],t[18]=s[(i>>=4)&15],t[21]=s[(i>>=4)&15],t[20]=s[(i>>=4)&15],t[23]=s[(i>>=4)&15],t[22]=s[(i>>=4)&15],i=u[3],t[25]=s[i&15],t[24]=s[(i>>=4)&15],t[27]=s[(i>>=4)&15],t[26]=s[(i>>=4)&15],t[29]=s[(i>>=4)&15],t[28]=s[(i>>=4)&15],t[31]=s[(i>>=4)&15],t[30]=s[(i>>=4)&15],r?t:t.join("")}function g(e,t,n,r,i,s,o){return t+=e+r+o,(t<<i|t>>>s)+n<<0}function y(e){w(0,0,0,0,e),u[0]=c[0]+1732584193<<0,u[1]=c[1]-271733879<<0,u[2]=c[2]-1732584194<<0,u[3]=c[3]+271733878<<0}function b(e){w(u[0],u[1],u[2],u[3],e),u[0]=c[0]+u[0]<<0,u[1]=c[1]+u[1]<<0,u[2]=c[2]+u[2]<<0,u[3]=c[3]+u[3]<<0}function w(e,t,n,r,i){var s,o;a?(e=g((n^r)&t^r,e,t,i[0],7,25,-680876936),r=g((t^n)&e^n,r,e,i[1],12,20,-389564586),n=g((e^t)&r^t,n,r,i[2],17,15,606105819),t=g((r^e)&n^e,t,n,i[3],22,10,-1044525330)):(e=i[0]-680876937,e=(e<<7|e>>>25)-271733879<<0,r=i[1]-117830708+(2004318071&e^-1732584194),r=(r<<12|r>>>20)+e<<0,n=i[2]-1126478375+((e^-271733879)&r^-271733879),n=(n<<17|n>>>15)+r<<0,t=i[3]-1316259209+((r^e)&n^e),t=(t<<22|t>>>10)+n<<0),e=g((n^r)&t^r,e,t,i[4],7,25,-176418897),r=g((t^n)&e^n,r,e,i[5],12,20,1200080426),n=g((e^t)&r^t,n,r,i[6],17,15,-1473231341),t=g((r^e)&n^e,t,n,i[7],22,10,-45705983),e=g((n^r)&t^r,e,t,i[8],7,25,1770035416),r=g((t^n)&e^n,r,e,i[9],12,20,-1958414417),n=g((e^t)&r^t,n,r,i[10],17,15,-42063),t=g((r^e)&n^e,t,n,i[11],22,10,-1990404162),e=g((n^r)&t^r,e,t,i[12],7,25,1804603682),r=g((t^n)&e^n,r,e,i[13],12,20,-40341101),n=g((e^t)&r^t,n,r,i[14],17,15,-1502002290),t=g((r^e)&n^e,t,n,i[15],22,10,1236535329),e=g((t^n)&r^n,e,t,i[1],5,27,-165796510),r=g((e^t)&n^t,r,e,i[6],9,23,-1069501632),n=g((r^e)&t^e,n,r,i[11],14,18,643717713),t=g((n^r)&e^r,t,n,i[0],20,12,-373897302),e=g((t^n)&r^n,e,t,i[5],5,27,-701558691),r=g((e^t)&n^t,r,e,i[10],9,23,38016083),n=g((r^e)&t^e,n,r,i[15],14,18,-660478335),t=g((n^r)&e^r,t,n,i[4],20,12,-405537848),e=g((t^n)&r^n,e,t,i[9],5,27,568446438),r=g((e^t)&n^t,r,e,i[14],9,23,-1019803690),n=g((r^e)&t^e,n,r,i[3],14,18,-187363961),t=g((n^r)&e^r,t,n,i[8],20,12,1163531501),e=g((t^n)&r^n,e,t,i[13],5,27,-1444681467),r=g((e^t)&n^t,r,e,i[2],9,23,-51403784),n=g((r^e)&t^e,n,r,i[7],14,18,1735328473),t=g((n^r)&e^r,t,n,i[12],20,12,-1926607734),s=t^n,e=g(s^r,e,t,i[5],4,28,-378558),r=g(s^e,r,e,i[8],11,21,-2022574463),o=r^e,n=g(o^t,n,r,i[11],16,16,1839030562),t=g(o^n,t,n,i[14],23,9,-35309556),s=t^n,e=g(s^r,e,t,i[1],4,28,-1530992060),r=g(s^e,r,e,i[4],11,21,1272893353),o=r^e,n=g(o^t,n,r,i[7],16,16,-155497632),t=g(o^n,t,n,i[10],23,9,-1094730640),s=t^n,e=g(s^r,e,t,i[13],4,28,681279174),r=g(s^e,r,e,i[0],11,21,-358537222),o=r^e,n=g(o^t,n,r,i[3],16,16,-722521979),t=g(o^n,t,n,i[6],23,9,76029189),s=t^n,e=g(s^r,e,t,i[9],4,28,-640364487),r=g(s^e,r,e,i[12],11,21,-421815835),o=r^e,n=g(o^t,n,r,i[15],16,16,530742520),t=g(o^n,t,n,i[2],23,9,-995338651),e=g(n^(t|~r),e,t,i[0],6,26,-198630844),r=g(t^(e|~n),r,e,i[7],10,22,1126891415),n=g(e^(r|~t),n,r,i[14],15,17,-1416354905),t=g(r^(n|~e),t,n,i[5],21,11,-57434055),e=g(n^(t|~r),e,t,i[12],6,26,1700485571),r=g(t^(e|~n),r,e,i[3],10,22,-1894986606),n=g(e^(r|~t),n,r,i[10],15,17,-1051523),t=g(r^(n|~e),t,n,i[1],21,11,-2054922799),e=g(n^(t|~r),e,t,i[8],6,26,1873313359),r=g(t^(e|~n),r,e,i[15],10,22,-30611744),n=g(e^(r|~t),n,r,i[6],15,17,-1560198380),t=g(r^(n|~e),t,n,i[13],21,11,1309151649),e=g(n^(t|~r),e,t,i[4],6,26,-145523070),r=g(t^(e|~n),r,e,i[11],10,22,-1120210379),n=g(e^(r|~t),n,r,i[2],15,17,718787259),t=g(r^(n|~e),t,n,i[9],21,11,-343485551),c[0]=e,c[1]=t,c[2]=n,c[3]=r}var t=[],n=[],r=[],i=[],s="0123456789abcdef".split(""),o=[],u=[],a=!1,f=0,l=0,c=[];if(e.Int32Array)n=new Int32Array(16),r=new Int32Array(16),i=new Int32Array(4),o=new Int32Array(4),u=new Int32Array(4),c=new Int32Array(4);else{var h;for(h=0;h<16;h++)n[h]=r[h]=0;for(h=0;h<4;h++)i[h]=o[h]=u[h]=c[h]=0}i[0]=128,i[1]=32768,i[2]=8388608,i[3]=-2147483648,o[0]=0,o[1]=8,o[2]=16,o[3]=24,e.md5=e.md5||m}(typeof global=="undefined"?window:global)}),s("mixins/api",["require","lib/md5"],function(e){"use strict";return e("lib/md5"),{dataId:function(e,t,n){if(!e||!t)throw new Error("must pass url and verb to the api functions");return n=typeof n=="object"?n:{},md5(e+t+JSON.stringify(n))},ajax:function(e){if(!e.url||!e.type)throw new Error("must pass url and type to the api functions");var t=typeof e.useCache=="undefined"?!0:e.useCache,n=this,r=this.dataId(e.url,e.type,e.payload);if(e.method){var i=typeof e.method=="function"?e.method:this[e.method];this.dispatcher.once("api:"+r+":received",function(e){i.call(n,e)})}if(!o.api.queue[r]){o.api.queue[r]=!0,this.dispatch("api:"+r+":requested");var s;if(o.api.cache[r]&&t)s=$.Deferred().resolve(o.api.cache[r]);else{var u={contentType:"application/json; charset=utf-8",dataType:"json",data:e.payload?JSON.stringify(e.payload):""},a=$.extend(u,e);delete a.method,delete a.payload,s=$.ajax(a)}s.done(function(i){t&&(o.api.cache[r]=i),delete o.api.queue[r],n.dispatch("api:"+r+":received",i),e.eventName&&n.dispatch(e.eventName,i)}).fail(function(e,t){delete o.api.queue[r],n.dispatch("api:"+r+":failed",t),n.dispatch("api:genericError",t)})}return r}}}),s("classes/endpoints",["require","backbone.marionette","mixins/dispatcher","mixins/api"],function(e){var t=e("backbone.marionette"),n=e("mixins/dispatcher"),r=e("mixins/api");return endpoints=function(e){this.attributes={},t.Object.call(this,e)},_.extend(endpoints.prototype,t.Object.prototype,n,r,{get:function(e,t,n){var r=this,i=this.attributes[e];if(!i)throw new Error("The endpoint specified does not exist in this API Controller.");return typeof n=="function"?i.method=n:typeof n=="string"&&(i.method=function(e){r.dispatch(n,e)}),t&&(i.payload=t),i},set:function(e){_.extend(this.attributes,e)},call:function(e,t,n){return this.ajax(this.get(e,t,n))}}),endpoints.extend=t.Object.extend,new endpoints}),s("classes/apiController",["require","backbone.marionette","mixins/dispatcher","mixins/api"],function(e){var t=e("backbone.marionette"),n=e("mixins/dispatcher"),r=e("mixins/api");return apiController=function(e){t.Object.call(this,e)},_.extend(apiController.prototype,t.Object.prototype,n,r,{getEndpoint:function(e,t,n){var r=this,i=this[e];if(!i)throw new Error("The endpoint specified does not exist in this API Controller.");return typeof n=="function"?i.method=n:typeof n=="string"&&(i.method=function(e){r.dispatch(n,e)}),t&&(i.payload=t),i},callEndpoint:function(e,t,n){return this.ajax(this.getEndpoint(e,t,n))}}),apiController.extend=t.Object.extend,apiController}),s("mixins/waitFor",["require"],function(e){"use strict";return{waitFor:function(e){var t=this,n=$.Deferred(),r=[];typeof e=="string"&&(e=[e]);if(!$.isArray(e))throw new Error("WaitFor(actions) needs  an array of actions (or a single action)");return this.dispatch("waitFor:loading"),_.each(e,function(e){var n=$.Deferred();r.push(n);if(typeof e=="string")this.dispatcher.once(e,function(e){n.resolve(e)});else{if(e.method){var i=typeof e.method=="function"?e.method:t[e.method];if(typeof i!="function")throw new Error("method "+e.method+" is not defined")}var s=this.ajax($.extend(e,{method:function(e){i&&i.call(t,e),n.resolve(e)}}));this.dispatcher.once("api:"+s+":failed",function(e){n.reject(e)})}setTimeout(function(){n.state()!=="resolved"&&n.reject()},5e3)},this),$.when.apply($,r).done(function(){var e=arguments;setTimeout(function(){n.resolve(e),t.dispatch("LOADED",t.name)},0)}).fail(function(){n.reject(arguments)}),n}}}),s("mixins/dispatcherEvents",["require"],function(e){return function(){this.dispatcherEvents&&_.each(this.dispatcherEvents,function(e,t){if(typeof this[e]!="function"&&typeof e!="function")throw new Error("The store has a "+t+" action defined, but no method to handle it. Please define "+e+" on your store.");var n=typeof e=="function"?e:this[e];this.listenTo(this.dispatcher,t,n)},this)}}),s("mixins/endpointMethods",["require","classes/endpoints"],function(e){"use strict";var t=e("classes/endpoints");return{getEndpoint:t.get.bind(t),setEndpoint:t.set.bind(t),callEndpoint:t.call.bind(t)}}),s("classes/application",["require","backbone.marionette","mixins/dispatcher","mixins/api","mixins/waitFor","mixins/dispatcherEvents","mixins/endpointMethods"],function(e){var t=e("backbone.marionette"),n=e("mixins/dispatcher"),r=e("mixins/api"),i=e("mixins/waitFor"),s=e("mixins/dispatcherEvents"),o=e("mixins/endpointMethods"),u=function(e){t.Application.call(this,e)};return _.extend(u.prototype,t.Application.prototype,n,r,i,o),u.extend=t.Application.extend,u}),s("classes/collectionStore",["require","mixins/dispatcher","mixins/api","mixins/waitFor","mixins/dispatcherEvents","mixins/endpointMethods"],function(e){var t=e("mixins/dispatcher"),n=e("mixins/api"),r=e("mixins/waitFor"),i=e("mixins/dispatcherEvents"),s=e("mixins/endpointMethods"),o=function(e){i.call(this),Backbone.Collection.call(this,e)};return _.extend(o.prototype,Backbone.Collection.prototype,t,n,r,s),o.extend=Backbone.Collection.extend,o}),s("classes/modelStore",["require","mixins/dispatcher","mixins/api","mixins/waitFor","mixins/dispatcherEvents","mixins/endpointMethods"],function(e){var t=e("mixins/dispatcher"),n=e("mixins/api"),r=e("mixins/waitFor"),i=e("mixins/dispatcherEvents"),s=e("mixins/endpointMethods"),o=function(e){i.call(this),Backbone.Model.call(this,e)};return _.extend(o.prototype,Backbone.Model.prototype,t,n,r,s),o.extend=Backbone.Model.extend,o}),s("classes/router",["require","mixins/dispatcher","mixins/api","mixins/waitFor","mixins/dispatcherEvents","mixins/endpointMethods"],function(e){var t=e("mixins/dispatcher"),n=e("mixins/api"),r=e("mixins/waitFor"),i=e("mixins/dispatcherEvents"),s=e("mixins/endpointMethods"),o=function(e){i.call(this),Backbone.Router.call(this,e)};return _.extend(o.prototype,Backbone.Router.prototype,t,n,r,s),o.extend=Backbone.Router.extend,o}),s("classes/views",["require","backbone.marionette","mixins/dispatcher"],function(e){var t=e("backbone.marionette"),n=e("mixins/dispatcher"),r={};return r.ItemView=function(e){t.ItemView.call(this,e)},_.extend(r.ItemView.prototype,t.ItemView.prototype,n),r.ItemView.extend=t.ItemView.extend,r.CollectionView=function(e){t.CollectionView.call(this,e)},_.extend(r.CollectionView.prototype,t.CollectionView.prototype,n),r.CollectionView.extend=t.CollectionView.extend,r.CompositeView=function(e){t.CompositeView.call(this,e)},_.extend(r.CompositeView.prototype,t.CompositeView.prototype,n),r.CompositeView.extend=t.CompositeView.extend,r.LayoutView=function(e){t.LayoutView.call(this,e)},_.extend(r.LayoutView.prototype,t.LayoutView.prototype,n),r.LayoutView.extend=t.LayoutView.extend,r});var o={};return s("flux.marionette",["require","backbone.marionette","classes/endpoints","classes/apiController","classes/application","classes/collectionStore","classes/modelStore","classes/router","classes/views"],function(e){"use strict";e("backbone.marionette"),typeof console=="undefined"&&(console={log:function(){},error:function(){}}),o.api={cache:{},queue:{}},o.Endpoints=e("classes/endpoints"),o.ApiController=e("classes/apiController"),o.Application=e("classes/application"),o.CollectionStore=e("classes/collectionStore"),o.ModelStore=e("classes/modelStore"),o.Router=e("classes/router");var t=e("classes/views");return o=$.extend(o,t),console.debug=console.debug||console.log,o}),s("jquery",function(){return $}),s("underscore",function(){return _}),s("backbone.marionette",function(){return t}),s("backbone.radio",function(){return Backbone.Radio}),i("flux.marionette")});